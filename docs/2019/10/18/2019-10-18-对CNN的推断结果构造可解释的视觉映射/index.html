<!DOCTYPE html>
<html lang="en">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/blog/img/favicon.ico">

    <title>
        
        对CNN的推断结果构造可解释的视觉映射 - undefined
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/blog/css/aircloud.css">
<link rel="stylesheet" href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js">

    
<link rel="stylesheet" href="/blog/css/gitment.css">
<link rel="stylesheet" href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 5.4.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 浙江大学可视分析小组博客 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        <div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <a href="/"><img
                    src="/img/avatar.png" /></a>
        </div>
        <div class="name">
            <a href="/">
                <i>ZJU VAI</i>
            </a>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a
                    href="/">
                    <!-- <a href="/blog/about/"> -->
                    <!-- <i class="iconfont icon-fanhui"></i> -->
                    <span>🏠 小组主页</span>
                </a>
            </li>
            <li >
                <a href="/blog/">
                    <!-- <i class="iconfont icon-shouye1"></i> -->
                    <span>⌨️ 小组博客</span>
                </a>
            </li>
            <li >
                <a href="/blog/tags">
                    <!-- <i class="iconfont icon-biaoqian1"></i> -->
                    <span>📌 博客标签</span>
                </a>
            </li>
            <li >
                <a href="/blog/author">
                    <!-- <i class="iconfont icon-guanyu2"></i> -->
                    <span>👨‍🎓 作者存档</span>
                </a>
            </li>
            <li >
                <a href="/blog/archives">
                    <!-- <i class="iconfont icon-guidang2"></i> -->
                    <span>📅 时间存档</span>
                </a>
            </li>

            <li >
                <a href="/blog/textbook">
                    <!-- <i class="iconfont icon-biaoqian1"></i> -->
                    <span>📚 教材下载</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <!-- <i class="iconfont icon-sousuo1"></i> -->
                    <span>🔎 博客搜索</span>
                </a>
            </li>
            

            <br />
            
            <li >
                <a target="_blank" rel="noopener" href="https://zjuvag.gitee.io/blog/">
                    <!-- <i class="iconfont icon-biaoqian2"></i> -->
                    <!-- <span style="color:#536589;font-weight:bold;">nav.mirror</span> -->
                </a>
            </li>
        </ul>
    </div>
    
    <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8E%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95%E4%BB%8B%E7%BB%8D"><span class="toc-text">卷积神经网络与梯度下降法介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C"><span class="toc-text">卷积神经网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95"><span class="toc-text">梯度下降法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E8%A7%A3%E9%87%8A%E8%A7%86%E8%A7%89%E6%98%A0%E5%B0%84%EF%BC%9A%E6%89%BE%E5%88%B0%E6%A8%A1%E5%9E%8B%E6%8E%A8%E6%96%AD%E4%BE%9D%E6%8D%AE"><span class="toc-text">可解释视觉映射：找到模型推断依据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%86%E7%B2%92%E5%BA%A6%E6%96%B9%E6%B3%95"><span class="toc-text">细粒度方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B2%97%E7%B2%92%E5%BA%A6%E6%96%B9%E6%B3%95"><span class="toc-text">粗粒度方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E5%AD%90%E6%BF%80%E6%B4%BB%E6%98%A0%E5%B0%84%EF%BC%9A%E4%BB%8E%E5%88%86%E7%B1%BB%E5%99%A8%E5%88%B0%E6%97%A0%E7%9B%91%E7%9D%A3%E7%89%B9%E5%BE%81-Embedding-%E6%A8%A1%E5%9E%8B"><span class="toc-text">因子激活映射：从分类器到无监督特征 Embedding 模型</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input" />
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> 浙江大学可视分析小组博客 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        对CNN的推断结果构造可解释的视觉映射
    </div>

    <div class="post-meta">
        <!-- <span
            class="attr">发布于：<span>2019-10-18 00:00:00</span></span> -->
        <span class="attr">发布于：<span>2019-10-18</span></span>
        <span class="attr"><a class="tag" href="/blog/author/#冯浩哲"
                title="冯浩哲">冯浩哲</a></span>
        
        <span class="attr">/
            
            <a class="tag" href="/blog/tags/#报告" title="报告">报告</a>
            <span>/</span>
            
            <a class="tag" href="/blog/tags/#论文评述" title="论文评述">论文评述</a>
            <span>/</span>
            
            
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
        </span>
        </span>
    </div>
    <div class="post-content ">
        <p>报告：Interpretable Visual Explanations for the Inference of CNN</p>
<p>作者：Matthew D.Zeiler, Jost Tobias Springenberg</p>
<p>发表：ECCV(2015), ICLR(2015), CVPR (2016), ICCV(2017)</p>
<p>CNN 已经在序列数据的分类与特征学习问题上取得了巨大的成功，但是深度学习模型仍然是一个黑箱，其推断过程复杂难以直观理解。CNN 可视化技术利用梯度作为动力，对模型的推断结果自动生成可解释的视觉映射。该领域的代表作有 4 篇，按时间顺序依次为: <sup><a href="#fn_ 1" id="reffn_ 1"> 1</a></sup><sup><a href="#fn_ 2" id="reffn_ 2"> 2</a></sup><sup><a href="#fn_ 3" id="reffn_ 3"> 3</a></sup> <sup><a href="#fn_4" id="reffn_4">4</a></sup>. 本文对这 4 篇代表作进行综述性介绍，并给出对无监督特征提取模型生成视觉解释的办法。</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/office/yuque/0/2019/pptx/419889/1573812932711-be22306c-87c6-4b88-a6a2-3004f2715d6c.pptx">组会报告 PDF 链接</a></p>
<h2 id="卷积神经网络与梯度下降法介绍"><a href="#卷积神经网络与梯度下降法介绍" class="headerlink" title="卷积神经网络与梯度下降法介绍"></a>卷积神经网络与梯度下降法介绍</h2><h3 id="卷积神经网络"><a href="#卷积神经网络" class="headerlink" title="卷积神经网络"></a>卷积神经网络</h3><p>卷积运算是一种对<strong>序列数据</strong>进行特征匹配的方法, 卷积运算的输出是<strong>若干个相邻输入的加权求和</strong>。卷积运算常用于处理时间序列数据(金融数据, 经济数据), 以及空间序列数据(图数据，图像数据等)。</p>
<p>卷积神经网络是一种由<strong>多层卷积运算构成的模型</strong>，它能够将输入通过一层一层的过滤分解为不同粒度的特征，并在不同的粒度上学习相应的特征。每经过一层卷积层，特征就会<strong>在不同卷积核下分离</strong>，同时每一个分离特征的粒度则会损失一些，这个过程就是从细粒度特征(fine-grained) 到粗粒度特征(coarse-grained) 的分解过程。</p>
<p>卷积神经网络具有序列不变性，即它的所有特征层都保留了输入空间对应的序列关系，而这些序列关系在做出判断时非常重要。</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/eb58388bc5a2621cfa2158f9d297b411adbfa9e4.png" alt="cnn-1"></p>
<h3 id="梯度下降法"><a href="#梯度下降法" class="headerlink" title="梯度下降法"></a>梯度下降法</h3><p>对于一个复杂的模型损失函数 $f(\theta;X)$ 而言，我们总可以在 $\theta$ 离 $\theta_0$ 不远的地方把它写成</p>
<script type="math/tex; mode=display">
f(\theta)\approx f(\theta_0)+f'(\theta_0)(\theta-\theta_0)</script><p>利用这个近似公式, 如果我们给定一个比较小的区域$\theta \in (\theta_0-d,\theta_0+d)$， 在这个区域里，我们想要找到$f(\theta)$的最小值, 就应该利用该近似公式，将求$f(\theta)$的最小值的问题转化为求近似的一次方程最小值的问题。显然，这个一次线性函数最小值是沿着$-f^′ (θ_0 )$的方向前进 d 步长而得到的. 这里$d$就对应于学习率。一个优化过程如下图所示：</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/b1a6e3910414b319cae6003ce691206be30c5041.png" alt="2"></p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/b924588ab9dfc81a952297e838c07a78596ed061.png" alt="3"></p>
<h2 id="可解释视觉映射：找到模型推断依据"><a href="#可解释视觉映射：找到模型推断依据" class="headerlink" title="可解释视觉映射：找到模型推断依据"></a>可解释视觉映射：找到模型推断依据</h2><p>当我们说深度模型的可解释性的时候，我们在说什么？用动力学理论打开黑箱，用扰动理论构造对抗样本，还有——用视觉解释模型做出推断的依据。位置，轮廓，注意力焦点都是很好的依据，如下图所示，当模型判断这个人具有胸腔积液的时候，我们希望同时能得到模型的判断依据——积液位置与积液轮廓</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/eff9d87c5c610d0482c4da0b50dce8813ba268e4.png" alt="4"></p>
<h3 id="细粒度方法"><a href="#细粒度方法" class="headerlink" title="细粒度方法"></a>细粒度方法</h3><p>负梯度方向是让损失函数变得更小的方向，训练过程中，我们令参数沿着负梯度方向不断前进，使得参数能够拟合数据。一个很自然的想法是，当参数固定以后，我们能不能通过计算数据的梯度，来得到目标参数推断所对应于数据的焦点呢？对于分类得分$y$，我们想看看增强输入图像的哪些部分可以让模型对当前分类更加地有信心, 那么我们可以沿着梯度方向，即沿着让$y$变得更大的方向来激活输入，从而得到对应的细粒度(fine-grained) 视觉解释,如图所示</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/229b41b64013a232fdf4f694f2f8cbf3592a3c51.png" alt="5"></p>
<h3 id="粗粒度方法"><a href="#粗粒度方法" class="headerlink" title="粗粒度方法"></a>粗粒度方法</h3><p>细粒度将梯度转变为输入空间的激活，但是这种激活没有具备分层功能，受限于相关性，对输入空间的激活往往容易同时激活原图中多个彼此相关的目标。如我们希望得到狗的推断信心更大，但是可能同时也会激活猫的轮廓，这就是未分层导致的相关性作祟。利用卷积神经网络的序列不变性，我们可以对粗粒度的分层特征同样进行梯度激活，并将激活结果直接插值到与输入空间相同大小，从而获得粗粒度的视觉解释。这种映射方法的梯度计算公式为</p>
<script type="math/tex; mode=display">
𝑅𝑒𝐿𝑈(\frac{𝜕𝑦}{𝜕𝐹^𝑖 })∗𝐹^𝑖</script><p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/d991b6841c01ef5bb1f5b106e200a6cf42f4295b.png" alt="6"></p>
<h2 id="因子激活映射：从分类器到无监督特征-Embedding-模型"><a href="#因子激活映射：从分类器到无监督特征-Embedding-模型" class="headerlink" title="因子激活映射：从分类器到无监督特征 Embedding 模型"></a>因子激活映射：从分类器到无监督特征 Embedding 模型</h2><p>以上 4 篇文章的方法有以下 3 个局限之处：</p>
<ol>
<li>仅能对分类器的 embedding 进行映射，无法进一步扩展到所有 embedding 方法</li>
<li>需要知道真实的分类标签，但是很多特征映射方法并没有标签</li>
<li>有时候，我们并不仅仅想知道某一个潜变量空间维度所对应的映射，我们希望知道几个潜变量联合起来的视觉解释是什么</li>
</ol>
<p>我们提出了自己的方法，对无监督 VAE 所提取的因子进行因子激活映射，大致思路如下：</p>
<p>首先，对于一个<strong>VAE</strong>模型</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/a404360c4a4ad56aa0f610fd56530a931567171e.png" alt="7"></p>
<p>我们通过训练 ELBO 得到它的因子分布，然后通过因子分布损失计算因子激活映射</p>
<p><img src="http://www.cad.zju.edu.cn/home/vagblog/images/photo_bed/2019/11/18/57696a6fcef1c0f21ff3a2f8607026fcc88b28af.png" alt="8"></p>
<blockquote id="fn_ 1">
<sup> 1</sup>. Visualizing and understanding convolutional networks<a href="#reffn_ 1" title="Jump back to footnote [ 1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_ 2">
<sup> 2</sup>. Striving for simplicity: The all convolutional net<a href="#reffn_ 2" title="Jump back to footnote [ 2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_ 3">
<sup> 3</sup>. Learning Deep Features for Discriminative Localization<a href="#reffn_ 3" title="Jump back to footnote [ 3] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_ 4">
<sup> 4</sup>. Grad-CAM:Visual Explanations from Deep Networks via Gradient-based Localization<a href="#reffn_ 4" title="Jump back to footnote [ 4] in the text."> &#8617;</a>
</blockquote>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <hr/>
        <div id="lv-container">
            Questions & Discussion：<a href="mailto:fenghz@zju.edu.cn"><code> ✉️ fenghz@zju.edu.cn </code> </a>
        </div>
        <hr/>
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <ul class="list-inline text-center">
             
    </ul>
    
    <p>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> Theme
        <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a>
    </p>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/blog/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/blog/js/index.js"></script>
<script href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
