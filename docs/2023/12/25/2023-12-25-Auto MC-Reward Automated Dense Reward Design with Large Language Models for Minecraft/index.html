<!DOCTYPE html>
<html lang="en">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/blog/img/favicon.ico">

    <title>
        
        Auto MC-Reward Automated Dense Reward Design with Large Language Models for Minecraft - undefined
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/blog/css/aircloud.css">
<link rel="stylesheet" href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js">

    
<link rel="stylesheet" href="/blog/css/gitment.css">
<link rel="stylesheet" href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 5.4.2"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 浙江大学可视分析小组博客 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        <div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <a href="/"><img
                    src="/img/avatar.png" /></a>
        </div>
        <div class="name">
            <a href="/">
                <i>ZJU VAI</i>
            </a>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a
                    href="/">
                    <!-- <a href="/blog/about/"> -->
                    <!-- <i class="iconfont icon-fanhui"></i> -->
                    <span>🏠 小组主页</span>
                </a>
            </li>
            <li >
                <a href="/blog/">
                    <!-- <i class="iconfont icon-shouye1"></i> -->
                    <span>⌨️ 小组博客</span>
                </a>
            </li>
            <li >
                <a href="/blog/tags">
                    <!-- <i class="iconfont icon-biaoqian1"></i> -->
                    <span>📌 博客标签</span>
                </a>
            </li>
            <li >
                <a href="/blog/author">
                    <!-- <i class="iconfont icon-guanyu2"></i> -->
                    <span>👨‍🎓 作者存档</span>
                </a>
            </li>
            <li >
                <a href="/blog/archives">
                    <!-- <i class="iconfont icon-guidang2"></i> -->
                    <span>📅 时间存档</span>
                </a>
            </li>

            <li >
                <a href="/blog/textbook">
                    <!-- <i class="iconfont icon-biaoqian1"></i> -->
                    <span>📚 教材下载</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <!-- <i class="iconfont icon-sousuo1"></i> -->
                    <span>🔎 博客搜索</span>
                </a>
            </li>
            

            <br />
            
            <li >
                <a target="_blank" rel="noopener" href="https://zjuvag.gitee.io/blog/">
                    <!-- <i class="iconfont icon-biaoqian2"></i> -->
                    <!-- <span style="color:#536589;font-weight:bold;">nav.mirror</span> -->
                </a>
            </li>
        </ul>
    </div>
    
    <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D"><span class="toc-text">背景介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="toc-text">相关工作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E4%BC%98%E5%8C%96%EF%BC%9A"><span class="toc-text">强化学习优化：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%9B%86%E5%A5%96%E5%8A%B1%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="toc-text">密集奖励函数：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RL%E4%B8%AD%E5%BC%95%E5%85%A5LLM"><span class="toc-text">RL中引入LLM</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BB%8B%E7%BB%8D"><span class="toc-text">方法介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%80%E3%80%81Reward-Designer"><span class="toc-text">模块一、Reward Designer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%BA%8C%E3%80%81Reward-Critic"><span class="toc-text">模块二、Reward Critic</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%89%E3%80%81Trajectory-Analyzer"><span class="toc-text">模块三、Trajectory Analyzer</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%8B%E7%BB%8D"><span class="toc-text">实验介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Auto-MC-Reward%E6%A1%86%E6%9E%B6%E8%AE%AD%E7%BB%83"><span class="toc-text">Auto MC-Reward框架训练</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E8%AE%BE%E8%AE%A1%E5%92%8C%E5%9F%BA%E5%87%86%E6%A8%A1%E5%9E%8B"><span class="toc-text">任务设计和基准模型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text">实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input" />
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> 浙江大学可视分析小组博客 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        Auto MC-Reward Automated Dense Reward Design with Large Language Models for Minecraft
    </div>

    <div class="post-meta">
        <!-- <span
            class="attr">发布于：<span>2023-12-25 00:00:00</span></span> -->
        <span class="attr">发布于：<span>2023-12-25</span></span>
        <span class="attr"><a class="tag" href="/blog/author/#陈俊旭"
                title="陈俊旭">陈俊旭</a></span>
        
        <span class="attr">/
            
            <a class="tag" href="/blog/tags/#报告" title="报告">报告</a>
            <span>/</span>
            
            <a class="tag" href="/blog/tags/#论文评述" title="论文评述">论文评述</a>
            <span>/</span>
            
            
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
        </span>
        </span>
    </div>
    <div class="post-content ">
        <p>论文：Auto MC-Reward Automated Dense Reward Design with Large Language Models for Minecraft</p>
<p>作者：Hao Li, Xue Yang, Zhaokai Wang, Xizhou Zhu, Jie Zhou, Yu Qiao, Xiaogang Wang, Hongsheng Li, Lewei Lu, Jifeng Dai</p>
<p>发表：arKiv</p>
<p>传统的基于强化学习的代理主要依赖稀疏奖励，这种奖励通常只使用二进制值来表示任务的完成或失败。这种探索效率的挑战使得在Minecraft中有效学习复杂任务变得困难。为了解决这个问题，本文引入了一种先进的学习系统，名为Auto MC-Reward，它利用大型语言模型（LLMs）自动设计密集奖励函数，从而提高学习效率。Auto MC-Reward包括三个重要的组成部分：奖励设计器、奖励评判器和轨迹分析器。给定环境信息和任务描述，奖励设计器首先通过编写一个具有预定义观察输入的可执行Python函数来设计奖励函数。然后，奖励评判器将负责验证代码，检查代码是否自洽，是否没有语法和语义错误。此外，轨迹分析器总结可能的失败原因，并根据收集的轨迹提供改进建议。在下一轮中，奖励设计器将根据反馈进一步优化并迭代密集奖励函数。实验结果显示，本文的agent在Minecraft中的复杂任务中，如有效避开熔岩并获取钻石，以及在平原生物群落中有效探索稀疏的树木和动物，成功率和学习效率都有显著提高。 </p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2312.09238">论文链接</a></p>
<h2 id="背景介绍"><a href="#背景介绍" class="headerlink" title="背景介绍"></a>背景介绍</h2><p>在缺乏大规模标签化的训练，且需要在不确定环境中进行任务探索时，强化学习一般来说是最优的选择，但传统的强化学习一般采用的稀疏奖励，即任务的反馈结果只有最终的成功或者失败，在任务中途不会给agent奖励信号，在面对复杂环境下的巨大决策空间时，这样的方法就显得效率低下</p>
<p>当然目前也存在一些解决办法，主要就是通过一些模仿学习来缩小决策空间，但这仍然无法避免agent和环境之间的大量交互</p>
<p>所以针对传统的强化学习所面临的挑战，本文提出了一套框架，用大语言模型来为强化学习自动化生成密集奖励函数，即该函数不仅包括最终的任务完成结果奖励反馈，还包括了在任务中途的奖励信号。</p>
<p>该框架包括三个模块：一是用于自动生成密集奖励函数的reward designer，二是用于检查奖励是否存在语法和语义错误的reward critic，最后一个模块trajectory analyzer，也是真正用到了LLM的总结和推理能力的模块，它主要根据任务失败的轨迹数据，分析失败原因，然后给reward designer反馈奖励函数的修改建议</p>
<p>所以整个框架的工作流程就是：reward designer生成奖励函数，reward critic审查奖励函数，审查通过的奖励函数用于强化学习训练，最后trajectory analyzer分析失败的轨迹数据，将修改建议反馈给reward designer，之后reward designer再迭代生成更优的奖励函数</p>
<p><img src="./workflow.png" alt=""></p>
<h2 id="相关工作"><a href="#相关工作" class="headerlink" title="相关工作"></a>相关工作</h2><h4 id="强化学习优化："><a href="#强化学习优化：" class="headerlink" title="强化学习优化："></a>强化学习优化：</h4><p>Hierarchical RL、curriculum learning、imitation learning</p>
<h4 id="密集奖励函数："><a href="#密集奖励函数：" class="headerlink" title="密集奖励函数："></a>密集奖励函数：</h4><p>Curiosity-driven exploration、self-imitation learning、goal-conditioned RL</p>
<h4 id="RL中引入LLM"><a href="#RL中引入LLM" class="headerlink" title="RL中引入LLM"></a>RL中引入LLM</h4><p>在本文之前也有人在RL中引入LLM，不过他们要么是将LLM作为一个高层的计划者来分解复杂任务，而并非像本文这样用LLM来生成奖励函数  </p>
<h2 id="方法介绍"><a href="#方法介绍" class="headerlink" title="方法介绍"></a>方法介绍</h2><h4 id="模块一、Reward-Designer"><a href="#模块一、Reward-Designer" class="headerlink" title="模块一、Reward Designer"></a>模块一、Reward Designer</h4><p>模块一reward designer，这个模块的功能就是利用LLM，根据具体的任务要求，游戏信息以及奖励函数相关的格式要求来直接生成可执行的python代码，</p>
<p>这个模块有三个特点：</p>
<p>一是在设计奖励函数考虑多步存储机制，因为一般而言，对于长线任务，agent需要在多个step之间传递信息</p>
<p>二是思维链机制，这个就是说让LLM在具体设计函数之前先讲讲它的设计思路，然后必要时在具体的代码上方加上注释细节</p>
<p>三是范围限制，reward designer会设计密集和稀疏两个奖励函数，对这两个函数的奖励返回值，都只考虑其符号，然后用下面这个公式来算最终的奖励数值，这是为了让奖励值维持在一个合理的范围，同时让LLM专注于各种场景，而不是调整奖励数值上</p>
<h4 id="模块二、Reward-Critic"><a href="#模块二、Reward-Critic" class="headerlink" title="模块二、Reward Critic"></a>模块二、Reward Critic</h4><p>reward critic就比较简单了，它主要是利用LLM来做三方面的工作，分别是对生成的奖励函数做语法和语义检查，然后对奖励函数运行是的可能报错做分析</p>
<p><img src="./reward-critic.png" alt=""></p>
<h4 id="模块三、Trajectory-Analyzer"><a href="#模块三、Trajectory-Analyzer" class="headerlink" title="模块三、Trajectory Analyzer"></a>模块三、Trajectory Analyzer</h4><p>第三个模块trajectory analyzer，这个模块算是真正意义上利用了LLM的总结和推理能力，因为尽管增加密集奖励函数，但和传统的强化学习一样，其也没有总结和推理的能力，而轨迹分析模块通过对失败任务轨迹进行分析，由LLM自动推断失败原因，然后将奖励函数的修改意见反馈给reward designer</p>
<p>以下图中的step2为例，当agent在岩浆附近死亡，则轨迹分析模块会将在遇到岩浆时增加处罚这一反馈信号传递给reward designer</p>
<p><img src="./trajectory-analyzer.png" alt=""></p>
<h2 id="实验介绍"><a href="#实验介绍" class="headerlink" title="实验介绍"></a>实验介绍</h2><h4 id="Auto-MC-Reward框架训练"><a href="#Auto-MC-Reward框架训练" class="headerlink" title="Auto MC-Reward框架训练"></a>Auto MC-Reward框架训练</h4><p><strong>LLM prompt:</strong> </p>
<p>1.流程指令：主要包括几个模块的控制命令</p>
<p>2.任务描述</p>
<p>3.游戏信息</p>
<p>4.失败轨迹的统计信息：trajectory analyzer模块需要的信息</p>
<p>5.输入参数：主要包括agent在任务过程中的环境参数和状态信息</p>
<p>6.奖励函数的格式和要求</p>
<p><strong>整个训练流程的伪代码：</strong></p>
<p><img src="./algorithm1.png" alt=""></p>
<h4 id="任务设计和基准模型"><a href="#任务设计和基准模型" class="headerlink" title="任务设计和基准模型"></a>任务设计和基准模型</h4><p><strong>四类任务</strong>（基于Minecraft的仿真平台MineDojo）：</p>
<p>1.在地下11层水平寻找钻石</p>
<p>2.靠近森林</p>
<p>3.靠近特定动物群体</p>
<p>4.获取钻石</p>
<p><strong>六个基准模型：</strong></p>
<p>1.Naive Handcraft</p>
<p>2.Imitation Learning(GITM)</p>
<p>3.RL with Sparse Reward</p>
<p>4.RL with Curiosity Dense Reward</p>
<p>5.RL with Self-Imitation Dense Reward</p>
<p>6.RL with MineCLIP Dense Reward</p>
<h2 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h2><p>基准模型和本文方法在三类任务下的结果对比：<strong>平均步数、死亡率、成功率</strong></p>
<p><img src="./baseline-result.png" alt=""></p>
<p><strong>结果说明：</strong></p>
<p>实验结果就是本文的结果比这几个基准模型的结果都要好，主要参考任务完成的平均步数、死亡率和任务成功率</p>
<p>这里唯一需要说明的一下就是使用稀疏奖励的强化学习在探索钻石任务中死亡率非常低的问题，这是因为采用了稀疏奖励的强化学习只探索了很少的空间，所以很少遇到岩浆</p>
<p>消融实验结果</p>
<p><img src="./ablation-result.png" alt=""></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>• 传统强化学习依赖稀疏奖励函数，决策空间大，效率低</p>
<p>• 本文利用LLM的总结和推理能力，自动迭代生成密集奖励函数，提高了强化学习的效率</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <hr/>
        <div id="lv-container">
            Questions & Discussion：<a href="mailto:zjuvis@cad.zju.edu.cn"><code> ✉️ zjuvis@cad.zju.edu.cn </code> </a>
        </div>
        <hr/>
    </div>
</div>
    </div>
</div>

<footer class="footer">
    <ul class="list-inline text-center">
             
    </ul>
    
    <p>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> Theme
        <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a>
    </p>
</footer>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/blog/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/blog/js/index.js"></script>
<script href="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.css" src="/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/blog/.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
